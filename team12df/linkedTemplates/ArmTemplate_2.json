{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "team12df"
		},
		"AzureBlobStorageVirtualMachine_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureBlobStorageVirtualMachine'"
		},
		"SqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'SqlServer'"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/odspolicy')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorageMetricsandPolicy",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "odspolicy.parquet",
						"fileSystem": "metric-and-policy-ods"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/odsrecoveries')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorageMetricsandPolicy",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "odsrecoveries.parquet",
						"fileSystem": "metric-and-policy-ods"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureBlobStorageVirtualMachine')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('AzureBlobStorageVirtualMachine_connectionString')]"
				},
				"connectVia": {
					"referenceName": "integrationRuntime1",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SqlServer')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"connectionString": "[parameters('SqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "integrationRuntime1",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1 - azuresql')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data Country",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "AzureSqlTable1_Country",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Parquet1_azuresqlpipeline",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy data Covid19",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "AzureSqlTable2_Covid19",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Parquet1_azuresqlpipeline",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy data Dates",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "AzureSqlTable3_Dates",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Parquet1_azuresqlpipeline",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-10-30T23:58:05Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline2 - cosmosdb - all columns')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "cosmosdb to parquet",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CosmosDbSqlApiSource",
								"preferredRegions": []
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['CountryName']"
										},
										"sink": {
											"name": "countryname",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['CountryCode']"
										},
										"sink": {
											"name": "countrycode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['RegionName']"
										},
										"sink": {
											"name": "regionname",
											"type": "Byte"
										}
									},
									{
										"source": {
											"path": "$['RegionCode']"
										},
										"sink": {
											"name": "regioncode",
											"type": "Byte"
										}
									},
									{
										"source": {
											"path": "$['Jurisdiction']"
										},
										"sink": {
											"name": "jurisdiction",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['Date']"
										},
										"sink": {
											"name": "date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['C1_School closing']"
										},
										"sink": {
											"name": "c1_school_closing",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C1_Flag']"
										},
										"sink": {
											"name": "c1_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['C2_Workplace closing']"
										},
										"sink": {
											"name": "c2_workplace_closing",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C2_Flag']"
										},
										"sink": {
											"name": "c2_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['C3_Cancel public events']"
										},
										"sink": {
											"name": "c3_cancel_public_events",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C3_Flag']"
										},
										"sink": {
											"name": "c3_Flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['C4_Restrictions on gatherings']"
										},
										"sink": {
											"name": "c4_restrictions_on_gatherings",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C4_Flag']"
										},
										"sink": {
											"name": "c4_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['C5_Close public transport']"
										},
										"sink": {
											"name": "c5_close_public_transport",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C5_Flag']"
										},
										"sink": {
											"name": "c5_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['C6_Stay at home requirements']"
										},
										"sink": {
											"name": "c6_stay_at_home_requirements",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C6_Flag']"
										},
										"sink": {
											"name": "c6_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['C7_Restrictions on internal movement']"
										},
										"sink": {
											"name": "c7_restrictions_on_internal_movement",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C7_Flag']"
										},
										"sink": {
											"name": "c7_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['C8_International travel controls']"
										},
										"sink": {
											"name": "c8_international_travel_controls",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['E1_Income support']"
										},
										"sink": {
											"name": "e1_income_support",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['E1_Flag']"
										},
										"sink": {
											"name": "e1_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['E2_Debt contract relief']"
										},
										"sink": {
											"name": "e2_debt_contract_relief",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['E3_Fiscal measures']"
										},
										"sink": {
											"name": "e3_fiscal_measures",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['E4_International support']"
										},
										"sink": {
											"name": "e4_international_support",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H1_Public information campaigns']"
										},
										"sink": {
											"name": "h1_public_information_campaigns",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H1_Flag']"
										},
										"sink": {
											"name": "h1_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['H2_Testing policy']"
										},
										"sink": {
											"name": "h2_testing_policy",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H3_Contact tracing']"
										},
										"sink": {
											"name": "h3_contact_tracing",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H4_Emergency investment in healthcare']"
										},
										"sink": {
											"name": "h4_emergency_investment_in_healthcare",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H5_Investment in vaccines']"
										},
										"sink": {
											"name": "h5_investment_in_vaccines",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H6_Facial Coverings']"
										},
										"sink": {
											"name": "h6_facial_coverings",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H6_Flag']"
										},
										"sink": {
											"name": "h6_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['H7_Vaccination policy']"
										},
										"sink": {
											"name": "h7_vaccination_policy",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H7_Flag']"
										},
										"sink": {
											"name": "h7_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['H8_Protection of elderly people']"
										},
										"sink": {
											"name": "h8_protection_of_elderly_people",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H8_Flag']"
										},
										"sink": {
											"name": "h8_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['M1_Wildcard']"
										},
										"sink": {
											"name": "m1_wildcard",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['StringencyIndex']"
										},
										"sink": {
											"name": "stringencyindex",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['StringencyIndexForDisplay']"
										},
										"sink": {
											"name": "stringencyindexfordisplay",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['StringencyLegacyIndex']"
										},
										"sink": {
											"name": "stringencylegacyindex",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['StringencyLegacyIndexForDisplay']"
										},
										"sink": {
											"name": "stringencylegacyindexfordisplay",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['GovernmentResponseIndex']"
										},
										"sink": {
											"name": "governmentresponseindex",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['GovernmentResponseIndexForDisplay']"
										},
										"sink": {
											"name": "governmentresponseindexfordisplay",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['ContainmentHealthIndex']"
										},
										"sink": {
											"name": "containmenthealthindex",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['ContainmentHealthIndexForDisplay']"
										},
										"sink": {
											"name": "containmenthealthindexfordisplay",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['EconomicSupportIndex']"
										},
										"sink": {
											"name": "economicsupportindex",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['EconomicSupportIndexForDisplay']"
										},
										"sink": {
											"name": "economicsupportindexfordisplay",
											"type": "Double"
										}
									}
								]
							}
						},
						"inputs": [
							{
								"referenceName": "CosmosDbNoSqlContainerCosmosdb",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ParquetNewPolicy",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-11-03T00:59:55Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline2-cosmosdb')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CosmosDB to Parquet",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "CosmosDbSqlApiSource",
								"preferredRegions": [],
								"detectDatetime": true
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['CountryName']"
										},
										"sink": {
											"name": "countryname",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['CountryCode']"
										},
										"sink": {
											"name": "countrycode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['Date']"
										},
										"sink": {
											"name": "date",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['C1_School closing']"
										},
										"sink": {
											"name": "c1_school_closing",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C1_Flag']"
										},
										"sink": {
											"name": "c1_Flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['C2_Workplace closing']"
										},
										"sink": {
											"name": "c2_workplace_closing"
										}
									},
									{
										"source": {
											"path": "$['C2_Flag']"
										},
										"sink": {
											"name": "c2_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['C3_Cancel public events']"
										},
										"sink": {
											"name": "c3_cancel_public_events",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C3_Flag']"
										},
										"sink": {
											"name": "c3_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['C4_Restrictions on gatherings']"
										},
										"sink": {
											"name": "c4_restrictions_on_gatherings",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C4_Flag']"
										},
										"sink": {
											"name": "c4_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['C5_Close public transport']"
										},
										"sink": {
											"name": "c5_close_public_transport",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C5_Flag']"
										},
										"sink": {
											"name": "c5_flag",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C6_Stay at home requirements']"
										},
										"sink": {
											"name": "c6_stay_at_home_requirements",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C6_Flag']"
										},
										"sink": {
											"name": "c6_flag",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C7_Restrictions on internal movement']"
										},
										"sink": {
											"name": "c7_restrictions_on_internal_movement",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['C7_Flag']"
										},
										"sink": {
											"name": "c7_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['C8_International travel controls']"
										},
										"sink": {
											"name": "c8_international_travel_controls",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['E1_Income support']"
										},
										"sink": {
											"name": "e1_income_support",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['E1_Flag']"
										},
										"sink": {
											"name": "e1_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['E2_Debt contract relief']"
										},
										"sink": {
											"name": "e2_debt_contract_relief",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['E3_Fiscal measures']"
										},
										"sink": {
											"name": "e3_fiscal_measures",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['E4_International support']"
										},
										"sink": {
											"name": "e4_international_support",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H1_Public information campaigns']"
										},
										"sink": {
											"name": "h1_public_information_campaigns",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H1_Flag']"
										},
										"sink": {
											"name": "h1_flag",
											"type": "Boolean"
										}
									},
									{
										"source": {
											"path": "$['H2_Testing policy']"
										},
										"sink": {
											"name": "h2_testing_policy",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H3_Contact tracing']"
										},
										"sink": {
											"name": "h3_contact_tracing",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H4_Emergency investment in healthcare']"
										},
										"sink": {
											"name": "h4_emergency_investment_in_healthcare",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['H5_Investment in vaccines']"
										},
										"sink": {
											"name": "h5_investment_in_vaccines",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['StringencyIndex']"
										},
										"sink": {
											"name": "stringencyindex",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['StringencyIndexForDisplay']"
										},
										"sink": {
											"name": "stringencyindexfordisplay",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['StringencyLegacyIndex']"
										},
										"sink": {
											"name": "StringencyLegacyIndex",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "$['id']"
										},
										"sink": {
											"name": "id"
										}
									}
								],
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "CosmosDbNoSqlContainerCosmosdb",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ParquetCosmosDBAgain",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-11-03T00:59:54Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ParquetCountry')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorageVirtualMachine",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "country.parquet",
						"container": "virtual-machine-data"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorageVirtualMachine')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ParquetDates')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorageVirtualMachine",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "dates.parquet",
						"container": "virtual-machine-data"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorageVirtualMachine')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ParquetMetrics')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorageVirtualMachine",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "metrics.parquet",
						"container": "virtual-machine-data"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/AzureBlobStorageVirtualMachine')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SqlServerCountry')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "SqlServer",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [
					{
						"name": "Country",
						"type": "varchar"
					},
					{
						"name": "CountryCode",
						"type": "varchar"
					},
					{
						"name": "Latitude",
						"type": "decimal",
						"precision": 10,
						"scale": 5
					},
					{
						"name": "Longitude",
						"type": "decimal",
						"precision": 10,
						"scale": 5
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "Country"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/SqlServer')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SqlServerDates')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "SqlServer",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [
					{
						"name": "DateKey",
						"type": "int",
						"precision": 10
					},
					{
						"name": "FullDate",
						"type": "date"
					},
					{
						"name": "isWeekDay",
						"type": "bit"
					},
					{
						"name": "DayOfWeek",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DayOfMonth",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DayOfQuarter",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DayOfYear",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DayName",
						"type": "varchar"
					},
					{
						"name": "WeekOfYear",
						"type": "int",
						"precision": 10
					},
					{
						"name": "WeekName",
						"type": "varchar"
					},
					{
						"name": "MonthOfYear",
						"type": "int",
						"precision": 10
					},
					{
						"name": "MonthName",
						"type": "varchar"
					},
					{
						"name": "CalendarQuarter",
						"type": "int",
						"precision": 10
					},
					{
						"name": "CalendarQuarterName",
						"type": "varchar"
					},
					{
						"name": "CalendarYear",
						"type": "int",
						"precision": 10
					},
					{
						"name": "FiscalMonth",
						"type": "int",
						"precision": 10
					},
					{
						"name": "FiscalMonthName",
						"type": "varchar"
					},
					{
						"name": "FiscalQuarter",
						"type": "int",
						"precision": 10
					},
					{
						"name": "FiscalQuarterName",
						"type": "varchar"
					},
					{
						"name": "FiscalYear",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "Dates"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/SqlServer')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SqlServerMetrics')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "SqlServer",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Updated",
						"type": "date"
					},
					{
						"name": "Confirmed",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Confirmed_Change",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Deaths",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Deaths_Change",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Recovered",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Recovered_Change",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Latitude",
						"type": "decimal",
						"precision": 10,
						"scale": 5
					},
					{
						"name": "Longitude",
						"type": "decimal",
						"precision": 10,
						"scale": 5
					},
					{
						"name": "ISO2",
						"type": "varchar"
					},
					{
						"name": "ISO3",
						"type": "varchar"
					},
					{
						"name": "Country_Region",
						"type": "varchar"
					},
					{
						"name": "load_time",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "Covid19_Metrics"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/SqlServer')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TEST2DataFlow')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Parquetvmmetrics",
								"type": "DatasetReference"
							},
							"name": "VMMetrics"
						},
						{
							"dataset": {
								"referenceName": "Parquetazuresqlmetrics",
								"type": "DatasetReference"
							},
							"name": "AzureMetrics"
						},
						{
							"dataset": {
								"referenceName": "Parquetvmmetrics",
								"type": "DatasetReference"
							},
							"name": "VMMetrics2"
						},
						{
							"dataset": {
								"referenceName": "Parquetazuresqlmetrics",
								"type": "DatasetReference"
							},
							"name": "AzureMetrics2"
						},
						{
							"dataset": {
								"referenceName": "Parquetvmmetrics",
								"type": "DatasetReference"
							},
							"name": "VMMetrics3"
						},
						{
							"dataset": {
								"referenceName": "Parquetazuresqlmetrics",
								"type": "DatasetReference"
							},
							"name": "AzureMetrics3"
						},
						{
							"dataset": {
								"referenceName": "Parquetvmcountry",
								"type": "DatasetReference"
							},
							"name": "VMCountry"
						},
						{
							"dataset": {
								"referenceName": "Parquetazuresqlcountry",
								"type": "DatasetReference"
							},
							"name": "AzureCountry"
						},
						{
							"dataset": {
								"referenceName": "Parquetvmdate",
								"type": "DatasetReference"
							},
							"name": "VMDates"
						},
						{
							"dataset": {
								"referenceName": "Parquetvmdate",
								"type": "DatasetReference"
							},
							"name": "AzureDates"
						},
						{
							"dataset": {
								"referenceName": "ParquetCosmosDB",
								"type": "DatasetReference"
							},
							"name": "CosmosPolicy"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "odscases",
								"type": "DatasetReference"
							},
							"name": "SinkCases"
						},
						{
							"dataset": {
								"referenceName": "odsdeaths",
								"type": "DatasetReference"
							},
							"name": "SinkDeaths"
						},
						{
							"dataset": {
								"referenceName": "odsrecoveries",
								"type": "DatasetReference"
							},
							"name": "SinkRecoveries"
						},
						{
							"dataset": {
								"referenceName": "odsgeographies",
								"type": "DatasetReference"
							},
							"name": "SinkGeographies"
						},
						{
							"dataset": {
								"referenceName": "odsdates",
								"type": "DatasetReference"
							},
							"name": "SinkDates"
						},
						{
							"dataset": {
								"referenceName": "odspolicy",
								"type": "DatasetReference"
							},
							"name": "SinkPolicy"
						}
					],
					"transformations": [
						{
							"name": "SelectCases"
						},
						{
							"name": "SelectCasesAzure"
						},
						{
							"name": "UnionCases"
						},
						{
							"name": "SelectDeaths"
						},
						{
							"name": "SelectDeaths2"
						},
						{
							"name": "UnionDeaths"
						},
						{
							"name": "SelectRecoveries"
						},
						{
							"name": "SelectRecoveries2"
						},
						{
							"name": "UnionRecoveries"
						},
						{
							"name": "SelectCountry"
						},
						{
							"name": "SelectCountry2"
						},
						{
							"name": "UnionGeographies"
						},
						{
							"name": "SelectDate"
						},
						{
							"name": "SelectDate2"
						},
						{
							"name": "UnionDates"
						},
						{
							"name": "SelectPolicy"
						}
					],
					"scriptLines": [
						"source(output(",
						"          ID as integer,",
						"          Updated as date,",
						"          Confirmed as integer,",
						"          Confirmed_Change as integer,",
						"          Deaths as integer,",
						"          Deaths_Change as integer,",
						"          Recovered as integer,",
						"          Recovered_Change as integer,",
						"          Latitude as decimal(10,5),",
						"          Longitude as decimal(10,5),",
						"          ISO2 as string,",
						"          ISO3 as string,",
						"          Country_Region as string,",
						"          load_time as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> VMMetrics",
						"source(output(",
						"          ID as integer,",
						"          Updated as date,",
						"          Confirmed as integer,",
						"          Confirmed_Change as integer,",
						"          Deaths as integer,",
						"          Deaths_Change as integer,",
						"          Recovered as integer,",
						"          Recovered_Change as integer,",
						"          Latitude as decimal(10,5),",
						"          Longitude as decimal(10,5),",
						"          ISO2 as string,",
						"          ISO3 as string,",
						"          Country_Region as string,",
						"          load_time as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> AzureMetrics",
						"source(output(",
						"          ID as integer,",
						"          Updated as date,",
						"          Confirmed as integer,",
						"          Confirmed_Change as integer,",
						"          Deaths as integer,",
						"          Deaths_Change as integer,",
						"          Recovered as integer,",
						"          Recovered_Change as integer,",
						"          Latitude as decimal(10,5),",
						"          Longitude as decimal(10,5),",
						"          ISO2 as string,",
						"          ISO3 as string,",
						"          Country_Region as string,",
						"          load_time as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> VMMetrics2",
						"source(output(",
						"          ID as integer,",
						"          Updated as date,",
						"          Confirmed as integer,",
						"          Confirmed_Change as integer,",
						"          Deaths as integer,",
						"          Deaths_Change as integer,",
						"          Recovered as integer,",
						"          Recovered_Change as integer,",
						"          Latitude as decimal(10,5),",
						"          Longitude as decimal(10,5),",
						"          ISO2 as string,",
						"          ISO3 as string,",
						"          Country_Region as string,",
						"          load_time as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> AzureMetrics2",
						"source(output(",
						"          ID as integer,",
						"          Updated as date,",
						"          Confirmed as integer,",
						"          Confirmed_Change as integer,",
						"          Deaths as integer,",
						"          Deaths_Change as integer,",
						"          Recovered as integer,",
						"          Recovered_Change as integer,",
						"          Latitude as decimal(10,5),",
						"          Longitude as decimal(10,5),",
						"          ISO2 as string,",
						"          ISO3 as string,",
						"          Country_Region as string,",
						"          load_time as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> VMMetrics3",
						"source(output(",
						"          ID as integer,",
						"          Updated as date,",
						"          Confirmed as integer,",
						"          Confirmed_Change as integer,",
						"          Deaths as integer,",
						"          Deaths_Change as integer,",
						"          Recovered as integer,",
						"          Recovered_Change as integer,",
						"          Latitude as decimal(10,5),",
						"          Longitude as decimal(10,5),",
						"          ISO2 as string,",
						"          ISO3 as string,",
						"          Country_Region as string,",
						"          load_time as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> AzureMetrics3",
						"source(output(",
						"          Country as string,",
						"          CountryCode as string,",
						"          Latitude as decimal(10,5),",
						"          Longitude as decimal(10,5)",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> VMCountry",
						"source(output(",
						"          Country as string,",
						"          CountryCode as string,",
						"          Latitude as decimal(10,5),",
						"          Longitude as decimal(10,5)",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> AzureCountry",
						"source(output(",
						"          DateKey as integer,",
						"          FullDate as date,",
						"          isWeekDay as boolean,",
						"          DayOfWeek as integer,",
						"          DayOfMonth as integer,",
						"          DayOfQuarter as integer,",
						"          DayOfYear as integer,",
						"          DayName as string,",
						"          WeekOfYear as integer,",
						"          WeekName as string,",
						"          MonthOfYear as integer,",
						"          MonthName as string,",
						"          CalendarQuarter as integer,",
						"          CalendarQuarterName as string,",
						"          CalendarYear as integer,",
						"          FiscalMonth as integer,",
						"          FiscalMonthName as string,",
						"          FiscalQuarter as integer,",
						"          FiscalQuarterName as string,",
						"          FiscalYear as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> VMDates",
						"source(output(",
						"          DateKey as integer,",
						"          FullDate as date,",
						"          isWeekDay as boolean,",
						"          DayOfWeek as integer,",
						"          DayOfMonth as integer,",
						"          DayOfQuarter as integer,",
						"          DayOfYear as integer,",
						"          DayName as string,",
						"          WeekOfYear as integer,",
						"          WeekName as string,",
						"          MonthOfYear as integer,",
						"          MonthName as string,",
						"          CalendarQuarter as integer,",
						"          CalendarQuarterName as string,",
						"          CalendarYear as integer,",
						"          FiscalMonth as integer,",
						"          FiscalMonthName as string,",
						"          FiscalQuarter as integer,",
						"          FiscalQuarterName as string,",
						"          FiscalYear as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> AzureDates",
						"source(output(",
						"          countryname as string,",
						"          countrycode as string,",
						"          regionname as integer,",
						"          regioncode as integer,",
						"          jurisdiction as string,",
						"          date as timestamp,",
						"          c1_school_closing as double,",
						"          c1_flag as boolean,",
						"          c2_workplace_closing as double,",
						"          c2_flag as boolean,",
						"          c3_cancel_public_events as double,",
						"          c3_Flag as boolean,",
						"          c4_restrictions_on_gatherings as double,",
						"          c4_flag as boolean,",
						"          c5_close_public_transport as double,",
						"          c5_flag as boolean,",
						"          c6_stay_at_home_requirements as double,",
						"          c6_flag as boolean,",
						"          c7_restrictions_on_internal_movement as double,",
						"          c7_flag as boolean,",
						"          c8_international_travel_controls as double,",
						"          e1_income_support as double,",
						"          e1_flag as boolean,",
						"          e2_debt_contract_relief as double,",
						"          e3_fiscal_measures as double,",
						"          e4_international_support as double,",
						"          h1_public_information_campaigns as double,",
						"          h1_flag as boolean,",
						"          h2_testing_policy as double,",
						"          h3_contact_tracing as double,",
						"          h4_emergency_investment_in_healthcare as double,",
						"          h5_investment_in_vaccines as double,",
						"          h6_facial_coverings as double,",
						"          h6_flag as boolean,",
						"          h7_vaccination_policy as double,",
						"          h7_flag as boolean,",
						"          h8_protection_of_elderly_people as double,",
						"          h8_flag as boolean,",
						"          m1_wildcard as double,",
						"          stringencyindex as double,",
						"          stringencyindexfordisplay as double,",
						"          stringencylegacyindex as double,",
						"          stringencylegacyindexfordisplay as double,",
						"          governmentresponseindex as double,",
						"          governmentresponseindexfordisplay as double,",
						"          containmenthealthindex as double,",
						"          containmenthealthindexfordisplay as double,",
						"          economicsupportindex as double,",
						"          economicsupportindexfordisplay as double",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> CosmosPolicy",
						"VMMetrics select(mapColumn(",
						"          Updated,",
						"          Confirmed,",
						"          Confirmed_Change,",
						"          ISO2,",
						"          ISO3,",
						"          Country_Region",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectCases",
						"AzureMetrics select(mapColumn(",
						"          Updated,",
						"          Confirmed,",
						"          Confirmed_Change,",
						"          ISO2,",
						"          ISO3,",
						"          Country_Region",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectCasesAzure",
						"SelectCases, SelectCasesAzure union(byName: true)~> UnionCases",
						"VMMetrics2 select(mapColumn(",
						"          Updated,",
						"          Deaths,",
						"          Deaths_Change,",
						"          ISO2,",
						"          ISO3,",
						"          Country_Region",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectDeaths",
						"AzureMetrics2 select(mapColumn(",
						"          Updated,",
						"          Deaths,",
						"          Deaths_Change,",
						"          ISO2,",
						"          ISO3,",
						"          Country_Region",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectDeaths2",
						"SelectDeaths, SelectDeaths2 union(byName: true)~> UnionDeaths",
						"VMMetrics3 select(mapColumn(",
						"          Updated,",
						"          Recovered,",
						"          Recovered_Change,",
						"          ISO2,",
						"          ISO3,",
						"          Country_Region",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectRecoveries",
						"AzureMetrics3 select(mapColumn(",
						"          Updated,",
						"          Recovered,",
						"          Recovered_Change,",
						"          ISO2,",
						"          ISO3,",
						"          Country_Region",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectRecoveries2",
						"SelectRecoveries, SelectRecoveries2 union(byName: true)~> UnionRecoveries",
						"VMCountry select(mapColumn(",
						"          Country,",
						"          CountryCode",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectCountry",
						"AzureCountry select(mapColumn(",
						"          Country,",
						"          CountryCode",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectCountry2",
						"SelectCountry, SelectCountry2 union(byName: true)~> UnionGeographies",
						"VMDates select(mapColumn(",
						"          FullDate,",
						"          CalendarQuarter",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectDate",
						"AzureDates select(mapColumn(",
						"          FullDate,",
						"          CalendarQuarter",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectDate2",
						"SelectDate, SelectDate2 union(byName: true)~> UnionDates",
						"CosmosPolicy select(mapColumn(",
						"          countryname,",
						"          countrycode,",
						"          regionname,",
						"          regioncode,",
						"          jurisdiction,",
						"          date,",
						"          c1_school_closing,",
						"          c1_flag,",
						"          c2_workplace_closing,",
						"          c2_flag,",
						"          c3_cancel_public_events,",
						"          c3_Flag,",
						"          c4_restrictions_on_gatherings,",
						"          c4_flag,",
						"          c5_close_public_transport,",
						"          c5_flag,",
						"          c6_stay_at_home_requirements,",
						"          c6_flag,",
						"          c7_restrictions_on_internal_movement,",
						"          c7_flag,",
						"          c8_international_travel_controls,",
						"          e1_income_support,",
						"          e1_flag,",
						"          e2_debt_contract_relief,",
						"          e3_fiscal_measures,",
						"          e4_international_support,",
						"          h1_public_information_campaigns,",
						"          h1_flag,",
						"          h2_testing_policy,",
						"          h3_contact_tracing,",
						"          h4_emergency_investment_in_healthcare,",
						"          h5_investment_in_vaccines,",
						"          h6_facial_coverings,",
						"          h6_flag,",
						"          h7_vaccination_policy,",
						"          h7_flag,",
						"          h8_protection_of_elderly_people,",
						"          h8_flag,",
						"          m1_wildcard,",
						"          stringencyindex,",
						"          stringencyindexfordisplay,",
						"          stringencylegacyindex,",
						"          stringencylegacyindexfordisplay,",
						"          governmentresponseindex,",
						"          governmentresponseindexfordisplay,",
						"          containmenthealthindex,",
						"          containmenthealthindexfordisplay,",
						"          economicsupportindex,",
						"          economicsupportindexfordisplay",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> SelectPolicy",
						"UnionCases sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'parquet',",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> SinkCases",
						"UnionDeaths sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'parquet',",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> SinkDeaths",
						"UnionRecoveries sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'parquet',",
						"     truncate: true,",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> SinkRecoveries",
						"UnionGeographies sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'parquet',",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> SinkGeographies",
						"UnionDates sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'parquet',",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> SinkDates",
						"SelectPolicy sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'parquet',",
						"     umask: 0022,",
						"     preCommands: [],",
						"     postCommands: [],",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     partitionBy('hash', 1)) ~> SinkPolicy"
					]
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/odsrecoveries')]",
				"[concat(variables('factoryId'), '/datasets/odspolicy')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/TESTDataFlow')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Parquetazuresqlcountry",
								"type": "DatasetReference"
							},
							"name": "TESTAzureSQLCountry"
						},
						{
							"dataset": {
								"referenceName": "Parquetazuresqlmetrics",
								"type": "DatasetReference"
							},
							"name": "TESTAzureSQLMetrics"
						},
						{
							"dataset": {
								"referenceName": "Parquetazuresqldate",
								"type": "DatasetReference"
							},
							"name": "TESTAzureSQLDates"
						},
						{
							"dataset": {
								"referenceName": "Parquetvmmetrics",
								"type": "DatasetReference"
							},
							"name": "TESTVMMetrics"
						},
						{
							"dataset": {
								"referenceName": "Parquetvmcountry",
								"type": "DatasetReference"
							},
							"name": "TESTVMCountry"
						},
						{
							"dataset": {
								"referenceName": "Parquetvmdate",
								"type": "DatasetReference"
							},
							"name": "TESTVMDates"
						},
						{
							"dataset": {
								"referenceName": "ParquetCosmosDB",
								"type": "DatasetReference"
							},
							"name": "TESTCosmosPolicy"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "TESTParquet",
								"type": "DatasetReference"
							},
							"name": "TESTsink"
						}
					],
					"transformations": [
						{
							"name": "TESTJoinCountryMetrics"
						},
						{
							"name": "TESTJoinAzureDates"
						},
						{
							"name": "TESTSelectAzureCountry"
						},
						{
							"name": "TESTSelectAzureMetrics"
						},
						{
							"name": "TESTSelectAzureDates"
						},
						{
							"name": "TESTSelectVMMetric"
						},
						{
							"name": "TESTSelectVMCountry"
						},
						{
							"name": "TestSelectVMDates"
						},
						{
							"name": "TESTJoinVMMetricCountry"
						},
						{
							"name": "TESTJoinVMDates"
						},
						{
							"name": "TESTSelectCosmos"
						},
						{
							"name": "TESTUnionAzureVM"
						},
						{
							"name": "TESTJoinEverything"
						}
					],
					"scriptLines": [
						"source(output(",
						"          Country as string,",
						"          CountryCode as string,",
						"          Latitude as decimal(10,5),",
						"          Longitude as decimal(10,5)",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> TESTAzureSQLCountry",
						"source(output(",
						"          ID as integer,",
						"          Updated as date,",
						"          Confirmed as integer,",
						"          Confirmed_Change as integer,",
						"          Deaths as integer,",
						"          Deaths_Change as integer,",
						"          Recovered as integer,",
						"          Recovered_Change as integer,",
						"          Latitude as decimal(10,5),",
						"          Longitude as decimal(10,5),",
						"          ISO2 as string,",
						"          ISO3 as string,",
						"          Country_Region as string,",
						"          load_time as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> TESTAzureSQLMetrics",
						"source(output(",
						"          DateKey as integer,",
						"          FullDate as date,",
						"          isWeekDay as boolean,",
						"          DayOfWeek as integer,",
						"          DayOfMonth as integer,",
						"          DayOfQuarter as integer,",
						"          DayOfYear as integer,",
						"          DayName as string,",
						"          WeekOfYear as integer,",
						"          WeekName as string,",
						"          MonthOfYear as integer,",
						"          MonthName as string,",
						"          CalendarQuarter as integer,",
						"          CalendarQuarterName as string,",
						"          CalendarYear as integer,",
						"          FiscalMonth as integer,",
						"          FiscalMonthName as string,",
						"          FiscalQuarter as integer,",
						"          FiscalQuarterName as string,",
						"          FiscalYear as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> TESTAzureSQLDates",
						"source(output(",
						"          ID as integer,",
						"          Updated as date,",
						"          Confirmed as integer,",
						"          Confirmed_Change as integer,",
						"          Deaths as integer,",
						"          Deaths_Change as integer,",
						"          Recovered as integer,",
						"          Recovered_Change as integer,",
						"          Latitude as decimal(10,5),",
						"          Longitude as decimal(10,5),",
						"          ISO2 as string,",
						"          ISO3 as string,",
						"          Country_Region as string,",
						"          load_time as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> TESTVMMetrics",
						"source(output(",
						"          Country as string,",
						"          CountryCode as string,",
						"          Latitude as decimal(10,5),",
						"          Longitude as decimal(10,5)",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> TESTVMCountry",
						"source(output(",
						"          DateKey as integer,",
						"          FullDate as date,",
						"          isWeekDay as boolean,",
						"          DayOfWeek as integer,",
						"          DayOfMonth as integer,",
						"          DayOfQuarter as integer,",
						"          DayOfYear as integer,",
						"          DayName as string,",
						"          WeekOfYear as integer,",
						"          WeekName as string,",
						"          MonthOfYear as integer,",
						"          MonthName as string,",
						"          CalendarQuarter as integer,",
						"          CalendarQuarterName as string,",
						"          CalendarYear as integer,",
						"          FiscalMonth as integer,",
						"          FiscalMonthName as string,",
						"          FiscalQuarter as integer,",
						"          FiscalQuarterName as string,",
						"          FiscalYear as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> TESTVMDates",
						"source(output(",
						"          countryname as string,",
						"          countrycode as string,",
						"          regionname as integer,",
						"          regioncode as integer,",
						"          jurisdiction as string,",
						"          date as timestamp,",
						"          c1_school_closing as double,",
						"          c1_flag as boolean,",
						"          c2_workplace_closing as double,",
						"          c2_flag as boolean,",
						"          c3_cancel_public_events as double,",
						"          c3_Flag as boolean,",
						"          c4_restrictions_on_gatherings as double,",
						"          c4_flag as boolean,",
						"          c5_close_public_transport as double,",
						"          c5_flag as boolean,",
						"          c6_stay_at_home_requirements as double,",
						"          c6_flag as boolean,",
						"          c7_restrictions_on_internal_movement as double,",
						"          c7_flag as boolean,",
						"          c8_international_travel_controls as double,",
						"          e1_income_support as double,",
						"          e1_flag as boolean,",
						"          e2_debt_contract_relief as double,",
						"          e3_fiscal_measures as double,",
						"          e4_international_support as double,",
						"          h1_public_information_campaigns as double,",
						"          h1_flag as boolean,",
						"          h2_testing_policy as double,",
						"          h3_contact_tracing as double,",
						"          h4_emergency_investment_in_healthcare as double,",
						"          h5_investment_in_vaccines as double,",
						"          h6_facial_coverings as double,",
						"          h6_flag as boolean,",
						"          h7_vaccination_policy as double,",
						"          h7_flag as boolean,",
						"          h8_protection_of_elderly_people as double,",
						"          h8_flag as boolean,",
						"          m1_wildcard as double,",
						"          stringencyindex as double,",
						"          stringencyindexfordisplay as double,",
						"          stringencylegacyindex as double,",
						"          stringencylegacyindexfordisplay as double,",
						"          governmentresponseindex as double,",
						"          governmentresponseindexfordisplay as double,",
						"          containmenthealthindex as double,",
						"          containmenthealthindexfordisplay as double,",
						"          economicsupportindex as double,",
						"          economicsupportindexfordisplay as double",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false,",
						"     format: 'parquet') ~> TESTCosmosPolicy",
						"TESTSelectAzureCountry, TESTSelectAzureMetrics join(Country == Country_Region,",
						"     joinType:'inner',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> TESTJoinCountryMetrics",
						"TESTJoinCountryMetrics, TESTSelectAzureDates join(Updated == Date,",
						"     joinType:'outer',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> TESTJoinAzureDates",
						"TESTAzureSQLCountry select(mapColumn(",
						"          Country",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> TESTSelectAzureCountry",
						"TESTAzureSQLMetrics select(mapColumn(",
						"          Updated,",
						"          Confirmed,",
						"          Confirmed_Change,",
						"          Deaths,",
						"          Deaths_Change,",
						"          Recovered,",
						"          Recovered_Change,",
						"          Country_Region",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> TESTSelectAzureMetrics",
						"TESTAzureSQLDates select(mapColumn(",
						"          Date = FullDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> TESTSelectAzureDates",
						"TESTVMMetrics select(mapColumn(",
						"          Updated,",
						"          Confirmed,",
						"          Confirmed_Change,",
						"          Deaths,",
						"          Deaths_Change,",
						"          Recovered,",
						"          Recovered_Change,",
						"          Country_Region",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> TESTSelectVMMetric",
						"TESTVMCountry select(mapColumn(",
						"          Country,",
						"          CountryCode",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> TESTSelectVMCountry",
						"TESTVMDates select(mapColumn(",
						"          FullDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> TestSelectVMDates",
						"TESTSelectVMMetric, TESTSelectVMCountry join(Country_Region == Country,",
						"     joinType:'outer',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> TESTJoinVMMetricCountry",
						"TESTJoinVMMetricCountry, TestSelectVMDates join(Updated == FullDate,",
						"     joinType:'outer',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> TESTJoinVMDates",
						"TESTCosmosPolicy select(mapColumn(",
						"          countryname,",
						"          countrycode,",
						"          regionname,",
						"          regioncode,",
						"          jurisdiction,",
						"          date,",
						"          c1_school_closing,",
						"          c1_flag,",
						"          c2_workplace_closing,",
						"          c2_flag,",
						"          c3_cancel_public_events,",
						"          c3_Flag,",
						"          c4_restrictions_on_gatherings,",
						"          c4_flag,",
						"          c5_close_public_transport,",
						"          c5_flag,",
						"          c6_stay_at_home_requirements,",
						"          c6_flag,",
						"          c7_restrictions_on_internal_movement,",
						"          c7_flag,",
						"          c8_international_travel_controls,",
						"          e1_income_support,",
						"          e1_flag,",
						"          e2_debt_contract_relief,",
						"          e3_fiscal_measures,",
						"          e4_international_support,",
						"          h1_public_information_campaigns,",
						"          h1_flag,",
						"          h2_testing_policy,",
						"          h3_contact_tracing,",
						"          h4_emergency_investment_in_healthcare,",
						"          h5_investment_in_vaccines,",
						"          h6_facial_coverings,",
						"          h6_flag,",
						"          h7_vaccination_policy,",
						"          h7_flag,",
						"          h8_protection_of_elderly_people,",
						"          h8_flag,",
						"          m1_wildcard,",
						"          stringencyindex,",
						"          stringencyindexfordisplay,",
						"          stringencylegacyindex,",
						"          stringencylegacyindexfordisplay,",
						"          governmentresponseindex,",
						"          governmentresponseindexfordisplay,",
						"          containmenthealthindex,",
						"          containmenthealthindexfordisplay,",
						"          economicsupportindex,",
						"          economicsupportindexfordisplay",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> TESTSelectCosmos",
						"TESTJoinAzureDates, TESTJoinVMDates union(byName: true)~> TESTUnionAzureVM",
						"TESTUnionAzureVM, TESTSelectCosmos join(Country == countryname,",
						"     joinType:'outer',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> TESTJoinEverything",
						"TESTJoinEverything sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     format: 'parquet',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     preCommands: [],",
						"     postCommands: []) ~> TESTsink"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1 - challenge2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CosmosAzureVM",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "TESTDataFlow",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"TESTAzureSQLCountry": {},
									"TESTAzureSQLMetrics": {},
									"TESTAzureSQLDates": {},
									"TESTVMMetrics": {},
									"TESTVMCountry": {},
									"TESTVMDates": {},
									"TESTCosmosPolicy": {},
									"TESTsink": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/TESTDataFlow')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1 - challenge2final')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ODSDataFlow",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "TEST2DataFlow",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"VMMetrics": {},
									"AzureMetrics": {},
									"VMMetrics2": {},
									"AzureMetrics2": {},
									"VMMetrics3": {},
									"AzureMetrics3": {},
									"VMCountry": {},
									"AzureCountry": {},
									"VMDates": {},
									"AzureDates": {},
									"CosmosPolicy": {},
									"SinkCases": {},
									"SinkDeaths": {},
									"SinkRecoveries": {},
									"SinkGeographies": {},
									"SinkDates": {},
									"SinkPolicy": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/TEST2DataFlow')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline3 - sqlserver')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "sql server country to parquet",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Country",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Country",
											"type": "String",
											"physicalType": "UTF8"
										}
									},
									{
										"source": {
											"name": "CountryCode",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CountryCode",
											"type": "String",
											"physicalType": "UTF8"
										}
									},
									{
										"source": {
											"name": "Latitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 10
										},
										"sink": {
											"name": "Latitude",
											"type": "Decimal",
											"physicalType": "DECIMAL"
										}
									},
									{
										"source": {
											"name": "Longitude",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 10
										},
										"sink": {
											"name": "Longitude",
											"type": "Decimal",
											"physicalType": "DECIMAL"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServerCountry",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ParquetCountry",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "sql server metrics to parquet",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServerMetrics",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ParquetMetrics",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "sql server date to parquet",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServerDates",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ParquetDates",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": [],
				"lastPublishTime": "2023-11-02T22:21:03Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SqlServerCountry')]",
				"[concat(variables('factoryId'), '/datasets/ParquetCountry')]",
				"[concat(variables('factoryId'), '/datasets/SqlServerMetrics')]",
				"[concat(variables('factoryId'), '/datasets/ParquetMetrics')]",
				"[concat(variables('factoryId'), '/datasets/SqlServerDates')]",
				"[concat(variables('factoryId'), '/datasets/ParquetDates')]"
			]
		}
	]
}